<html xmlns:th="http://www.thymeleaf.org" 
xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">


<head>
	<title>게시글 상세</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body th:align="center">
<h1>게시글 상세</h1>
<form th:action="@{/board/updateBoard}" method="post">
<table th:align="center" border="1" th:cellpadding="0" th:cellspacing="0">				
	<tr>
		<td bgcolor="orange" th:text="제목" width="80"></td>
		<td><input name="seq" type="hidden" th:value="${board.seq}">
		     <input name="title" type="text" th:value="${board.title}"></td>
	</tr>
	<tr>
		<td bgcolor="orange" th:text="분류"></td>
		<td th:text="${board.category}"></td>
	</tr>
	<tr>
		<td bgcolor="orange" th:text="작성자"></td>
		<td th:text="${board.member?.name}"></td>
	</tr>
	<tr>
		<td bgcolor="orange" th:text="내용">
		<td><textarea name="content" th:text="${board.content}" cols="40" rows="10"></textarea></td>
	</tr>
	<tr>
		<td bgcolor="orange" th:text="등록일"></td>
		<td th:text="${#dates.format(board.createDate, 'yyyy-MM-dd')}">
	</tr>
	<tr>
		<td bgcolor="orange" th:text="조회수"></td>
		<td th:text="${board.cnt}"></td>
	</tr>
	<tr>
		<td colspan="2" align="center">
			<input type="submit" value="게시글 수정">
		</td>
	</tr>
</table>
</form>

<!-- reply -->
<table th:align="center" border="1" th:cellpadding="0" th:cellspacing="0" th:width="750">
         <tr>
            <th bgcolor="green" width="100">작성자</th>
            <th bgcolor="green" width="550">내용</th>
            <th bgcolor="green" width="50">수정</th>
            <th bgcolor="green" width="50">삭제</th>
         </tr>
         <tr th:each="reply, state : ${replyList}">
            <td th:text="${reply.member.name}" th:align="center"></td>
            <td><textarea name="content" th:text="${reply.content}"  cols="71"></textarea></td>
            <td th:align="center"><a sec:authorize="hasRole('ROLE_MEMBER')" th:if="${reply.member.id==principal.username}" th:href="@{/board/replyUpdate(replyId=${reply.replyId},content=${content} ,seq=${board.seq})}" >v</a>
            <a sec:authorize="hasRole('ROLE_ADMIN')"  th:href="@{/board/replyUpdate(replyId=${reply.replyId},content=${content} ,seq=${board.seq})}" >v</a></td>
            <td th:align="center"><a sec:authorize="hasRole('ROLE_MEMBER')" th:if="${reply.member.id==principal.username}" th:href="@{/board/replyDelete(replyId=${reply.replyId}, seq=${board.seq})}" >v</a>
            <a sec:authorize="hasRole('ROLE_ADMIN')"  th:href="@{/board/replyDelete(replyId=${reply.replyId}, seq=${board.seq})}" >v</a></td>
         </tr>
      </table>
      <ul>
         <li th:each="page : ${#numbers.sequence(0, searchResult.getPage() - 1)}">
            <a th:href="@{/board/getBoard(page=${pageStat.index}, seq=${board.seq})}"
               th:text="${pageStat.index + 1}"></a>
         </li>
      </ul>	
      
      <form th:action="@{/board/replywrite(seq=${board.seq})}" method="post">
         <input type="text" id="content" name="content" placeholder="댓글을 입력해주세요">
         <span sec:authentication="principal.member.name"></span>
         <button type="submit">등록</button>
      </form>
      
      
<!-- 이미지 출력 -->
<h3>이미지 출력</h3>
      <div style="text-align: center;">
      	<div th:each="imageFile : ${all} " style="float:left -100px; margin: auto; display: inline-block; ">    
         <img th:src=" |/board/images/${imageFile.id}|"  width="150" height="150" style="text-align: center;">
         <p th:text="${imageFile.orgName}"></p>
     	</div>   
	</div>
	
	<div style="clear: both;">
      <h4>파일 다운로드</h4>
      <div th:each="file : ${all}">
            <a th:href="|/board/attach/${file.id}|" th:text="${file.orgName}"></a>
      </div>
      </div>
	

<div style="margin-top: 10px">
   <form th:action="@{/mail}" method="post">
        <input name="address" placeholder="이메일 주소"> <br>
        <input type="hidden" name="title" th:value="${board.title}" >
        <input type="hidden" name="message" th:value="${board.content}" ></input>
        <button style="margin-top: 10px">발송</button>
    </form>
</div>
 
<a th:href="@{/board/insertBoard}">글등록</a>&nbsp;&nbsp;&nbsp;
<a sec:authorize="hasRole('ROLE_ADMIN')" th:href="@{/board/deleteBoard(seq=${board.seq})}">글삭제</a>&nbsp;&nbsp;
<a th:href="@{/board/getBoardList}">글목록</a>
</body>
</html>
